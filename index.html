<!DOCTYPE html>
<html>
  <head>
    <title>JF2 Post Serialization Format</title>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common'
            async class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          license: "w3c-software-doc",
          specStatus: "ED",
          shortName:  "jf2",
          edDraftURI: "https://dissolve.github.io/jf2/",
          editors: [
                {   name:       "Benjamin Roberts",
                    url:        "https://ben.thatmustbe.me/",
                    w3cid:      "76388" },
                {   name:       "Kevin Marks",
                    url:        "http://www.kevinmarks.com/",
                    w3cid:      "" }
          ],
          wg:           "Social Web Working Group",
          wgURI:        "https://www.w3.org/Social/WG",
          wgPublicList: "public-socialweb",
          wgPatentURI:  "https://www.w3.org/2004/01/pp-impl/72531/status",
          noRecTrack:   true,
          otherLinks:   [
            {
              key: "Repository",
              data: [
                {
                  value: "GitHub",
                  href: "https://github.com/dissolve/jf2"
                },
                {
                  value: "Issues",
                  href: "https://github.com/dissolve/jf2/issues"
                },
                {
                  value: "Commits",
                  href: "https://github.com/dissolve/jf2/commits/gh-pages"
                }
              ]
            }, 
            {
              key: "Test",
              data: [
                {
                  value: "Validator",
                  href: "http://jf2.rocks/"
                },
                {
                  value: "Sample Set",
                  href: "http://jf2.rocks/"
                },
                {
                  value: "Implementation Reports",
                  href: "http://jf2.rocks/"
                }
              ]
            }

          ],
          localBiblio:  {
            "h-entry": {
              title: "h-entry",
              href: "http://microformats.org/wiki/h-entry",
              authors: [ "Tantek Çelik"],
              status: "Living Specification",
              publisher: "http://microformats.org"
            },
            "h-card": {
              title: "h-card",
              href: "http://microformats.org/wiki/h-card",
              authors: [ "Tantek Çelik"],
              status: "Living Specification",
              publisher: "http://microformats.org"
            },
            "h-feed": {
              title: "h-feed",
              href: "http://microformats.org/wiki/h-feed",
              authors: [ "Tantek Çelik"],
              status: "Living Specification",
              publisher: "http://microformats.org"
            },
            "microformats2": {
              title: "Microformats2",
              href: "http://microformats.org/wiki/microformats2",
              authors: [ "Tantek Çelik"],
              status: "Living Specification",
              publisher: "http://microformats.org"
            },
            "microformats2-parsing": {
              title: "Microformats2 Parsing",
              href: "http://microformats.org/wiki/microformats2-parsing",
              authors: [ "Tantek Çelik"],
              status: "Living Specification",
              publisher: "http://microformats.org"
            },
            "jsonfeed-v1": {
              title: "JSON Feed Version 1",
              href: "http://jsonfeed.org/version/1",
              authors: [ "Brent Simmons", "Manton Reece"],
              status: "Draft",
              publisher: "http://jsonfeed.org"
            },
          }
      };
    </script>
    <link rel="pingback" href="https://webmention.io/w3c/xmlrpc">
    <link rel="webmention" href="https://webmention.io/w3c/webmention">
  </head>
  <body>
    <section id='abstract'>
      <p>
        This document describes a JSON serialization format to describe simple
        streams of data as well as single objects of data for data transfer and
        processing.
      </p>
    </section>

    <section id='sotd'>
    </section>

    <section id='authorsnote' class='informative'>
      <h2>Author's Note</h2>
      <p>
        This document is an attempt to unify various simplified versions of the
        Microformats-2 representative JSON format.  As such, much of this document
        is likely to change as various implementations contribute input.
      </p>
    </section>
    
    <section class='informative'>
      <h2>Introduction</h2>
      <p>
        JF2 is a JSON based document format that describes lists and single entries
        of information.   The primary use case for JF2 is to create a JSON format for
        social web post objects to be processed directly by client software and by other
        servers.
      </p>
      <p>
        The name JF2 comes from its origins in being a direct parsed format of
        Microformats-2 (MF2) data from HTML.  Rather than defining a new vocabulary
        JF2 uses the vocabulary defined by [[microformats2]];
        however, any other suitable vocabulary could be used.  JF2 is vocabulary
        independent except for its profiles which are fully vocabulary aware.
      </p>
    </section>
    
    <section class='informative'>
      <h2>Use Cases</h2>
      <p>
        JF2 has evolved as a result of a variety of use-cases for different implementations
        exploring ways to simplify their existing use of canonical parsed Microformats-2 JSON
        output.  All of these use cases in particular are simply to have a single format for
        the storage and use of social web objects.
      </p>
      <p>
      <a href="#webmention.io">Webmention.io</a> is a service that provides Webmention
      processing and verification on behalf of other sites.  It uses a simple JSON object to
      transfer a processed Webmention back to the client site's JavaScript for display.  The
      attributes are intended to be processed only by the client site's JavaScript code, not
      by anything else.
      </p>
      <p>
      <a href="#mf2util">mf2util</a> is a utility library that provides a layer on top
      of microformats processing.  The library returns only a simple JSON object and strips
      off any unnecessary information leaving the library user only the most essential information.
      </p>
      <p>
      Various services (<a href="#xray">xray</a>, <a href="#unmung">unmung</a>, <a href="#socialstreams">socialstreams</a>)
      provide conversion from microformats pages in to JF2 for quick inspection to 
      validate proper semantics.
      </p>
    </section>

    <section id="conformance">
    
      <section>
        <h3>Documents</h3>

        <p>
          Conforming documents are those that comply with all the conformance
          criteria for JF2 documents. For readability, some of these conformance
          requirements are phrased as conformance requirements on publishers.
          Such requirements are implicitly requirements on documents: by
          definition, all documents are assumed to have a publisher.
        </p>

        <p>
          Conforming documents must not use features of JSON-LD or other
          serialization features disallowed in this specification. Conforming
          documents that include types or properties beyond those defined in
          [[microformats2]] must use its prefixing methods to indicate non-standard
          properties.
        </p>

        <p>
          A non-exhaustive list of examples of documents includes:

        </p>
        <ul>
          <li>
            A document representing an author
          </li>
          <li>
            A document representing an event
          </li>
          <li>
            A document representing a post
          </li>
          <li>
            A document representing a collection of the posts created by an author
          </li>
          <li>
            A document representing a collection of people
          </li>

        </ul>


      </section>

      <section>

        <h3>Implementations</h3>

        <p>
          Conforming implementations are software that publish, store, analyze,
          consume or otherwise process conforming documents. The two main kinds
          of implementations are publishers and consumers.
        </p>

        <section>

          <h4>Publishers</h4>

          <p>
            Conforming publishers are implementations that create and publish
            conforming documents. Conforming publishers must make conforming
            documents available according to the serialization requirements of
            this document. Conforming publishers must consider privacy as described
            in the <a href="#privacy">Privacy</a> section of this document.
            Conforming publishers must consider security as described in the
            <a href="#security-considerations">Security Considerations</a> section
            of this document.
          </p>

          <p>
            A non-exhaustive list of example publishers includes:
          </p>

          <ul>
            <li>
              A social network
            </li>
            <li>
              A personal web site
            </li>
            <li>
              A document publishing system
            </li>
            <li>
              A bridge from a non-conforming social network
            </li>
            <li>
              A document converter from similar document types such as RSS or
              Atom
            </li>
          </ul>

        </section>

        <section>

          <h4>Consumers</h4>

          <p>
            Conforming consumers are implementations that read and analyze
            conforming documents. Conforming consumers must not halt on any
            unrecognized properties or types.
          </p>

          <p>
            Conforming consumers may re-publish conforming documents in other
            other data formats. Conforming consumers may present conforming
            documents to a user on screen, in print, in audio format, or using
            other presentation mechanisms. Conforming consumers must faithfully
            translate the information represented in conforming documents into
            these other formats or media. Conforming consumers that re-publish
            conforming documents must consider privacy and security as described
            in the <a href="#privacy">Privacy</a> section and 
            <a href="#security-considerations">Security Considerations</a> section
            of this document.
          </p>

          <p>A non-exhaustive list of example consumers includes:</p>

          <ul>
            <li>
              A social network
            </li>
            <li>
              A search engine
            </li>
            <li>
              A feed reader
            </li>
            <li>
              A document validator
            </li>
            <li>
              A feed aggregator
            </li>
          </ul>

        </section>
      </section>

      <section class="informative">
        <h3>Validator and Reporting</h3>

        <p>
          A validator for conforming documents is available at
          <a href="https://jf2.rocks/">https://jf2.rocks/</a>.
          This also offers example conforming and non-conforming
          documents for testing purposes.
        </p>

        <p>
          Please submit your implementation reports at 
          <a href="https://jf2.rocks/">https://jf2.rocks/</a>.
          Instructions are provided at the URL.
        </p>

      </section>

    </section>



    <section id='syntax'>
      <h2>Syntax</h2>
      <p>
      JF2 consists of JSON objects which are defined by a <a>type</a> property that will specify
      the vocabulary of the object.  Properties are attached to these objects which will contain
      either a single string, a single object, an array of strings, or an array of objects.
      Arrays that have only a single item SHOULD be condensed into only the single containing item.
      Any property of an object MAY be a single item or an array of items except for reserved words
      defined below.
      </p>
      <section id='reservedkeywords'>
        <h3>Reserved Keywords</h3>
        <p>
          The following keywords are reserved and cannot be used as property names in vocabularies.
        </p>
        <ul>
          <li><dfn>type</dfn> defines the object classification.  In microformats, this is presumed
          to be an h-* class from the Microformats-2 vocabulary.
          Type MUST be a single string value and may not be an object or an array.  </li>
          <li><dfn>children</dfn> is a container for all unnamed sub-objects inside
          an entry.  That is, any sub-object that is not associated to a specific property of the object.
          If a children value is set, it MUST be serialized as an array even if only a
          single item is present.</li>
          <li><dfn>references</dfn> is an associative array, serialized as a JSON object, of all sub-objects
          inside an object which have <a>id</a> defined as an external URL. 
          Any objects in this array are not authoritative.
          If the references property is defined, it MUST be serialized as an associative array and MUST be
          present at the top level entry only.
          </li>
          <li><dfn>content-type</dfn> is the MIME media type of the containing object.
          Content-type MUST be a single string value only.</li>
          <li><dfn>html</dfn> is the text/html version of the containing object.
          Content-type MUST be a single string value only.</li>
          <li><dfn>text</dfn> is the text/plain version of the containing object.
          Content-type MUST be a single string value only.</li>
          <li><dfn>value</dfn> is a textual representation of the object.  By default this is presumed to be
          of content-type "text/plain".
          Value MUST be a single string value only.
          </li>
          <li><dfn>lang</dfn> is the localization language of the containing object and all
            sub-objects, unless overridden by another lang definition. 
            Setting lang at a lower level overrides any lang value set at higher levels.
            This value MUST be a single string value and MUST be a [[!RFC5646]] language tag.</li>
          <li><dfn>@context</dfn> is the context of the vocabulary as defined in [[JSON-LD]].
            This attribute MAY be omitted and has an inferred value if not present.  If it is present it MUST be
            present at the top level entry only.  See the <a href="#JSON-LD">JSON-LD Consideration</a> section.
          </li>
        </ul>
      </section>
  
      <section id='posts'>
        <h3>Posts</h3>

        <section id="post-objects">
          <h4>Post Objects</h4>
          <p>
            A post is composed of a "type" property, and one or more additional properties that describe the post.
          </p>
          <p>
          The "type" property has a value that describes the vocabulary of this post. Common values include "entry", "card", etc. See <a href="http://microformats.org/wiki/microformats-2#v2_vocabularies">Microformats-2 vocabularies</a> for the full list when using a microformats based vocabulary.
          </p>
          <p>
            Any additional properties in the post object are considered part of the post's vocabulary.
          </p>

        </section>
        <section id="post-properties">
          <h4>Post Properties</h4>
          <p>
            The list of valid post properties is defined by the vocabularies. This allows new vocabularies to be developed outside the development of the syntax.
          </p>
          <p>
            Most values will be strings. If a property (such as <a>author</a> for example) references another
            object, it may be serialized in two ways: as an object serialized as the property value or as
            the unique identifier or URL where the object can be found.  See <a href="#using-references">Using References</a>.
          </p>
          <p>
            Values may also be arrays if the vocabulary allows for multiple values of the property.
          </p>
           
        </section>
        <section id="example-post">
          <h4>Example Post</h4>

          <pre class="example">
            {
              "type": "entry",
              "published": "2015-10-20T15:49:00-0700",
              "url": "http://example.com/post/fsjeuu8372",
              "author": {
                "type": "card",
                "name": "Alice",
                "url": "http://alice.example.com",
                "photo": "http://alice.example.com/photo.jpg"
              },
              "name": "Hello World",
              "content": "This is a blog post",
              "category": "Posts"
            }
          </pre>

          <pre class="example">
            {
              "type": "entry",
              "published": "2015-10-20T15:49:00-0700",
              "url": "http://example.com/like/r23eugi02c",
              "author": {
                "type": "card",
                "name": "Alice",
                "url": "http://alice.example.com",
                "photo": "http://alice.example.com/photo.jpg"
              },
              "like-of": "http://bob.example.com/post/100",
              "category": ["Likes", "Posts"]
            }
          </pre>
        </section>
      </section>

      <section id="author">
        <h3>Author</h3>
        <p>
          An author is represented by the h-card vocabulary, and consists of a name, photo URL, URL to the author profile, and <a href="http://microformats.org/wiki/h-card">others</a>. This is represented by the following JSON.
        </p>

        <pre class="example">
          {
            "type": "card",
            "name": "Aaron Parecki",
            "photo": "http://aaronparecki.com/photo.jpg",
            "url": "http://aaronparecki.com/"
          }
        </pre>
      </section>

      <section id="html-content">
        <h3>HTML Content</h3>
        <p>
          By default, any string value should be interpreted as literal plaintext. 
          This means when displaying a string in an HTML page, it must be HTML escaped.
        </p>

        <p>
        If the value of a property is to be interpreted as HTML, it MUST be enclosed in
        an object and placed under the "html" property as follows.  If a plaintext version
        is also available, that is placed under the "text" property.
        </p>

        <pre class="example">
          {
            "type": "entry",
            "content": {
              "html": "&lt;p&gt;Hello World&lt;/p&gt;",
              "text": "Hello World"
            }
          }
        </pre>

        <section id="multiple-urls">
          <h4>Multiple URLs for video/audio/picture</h4>
          <p>
            Since HTML video/audio/picture tags may have multiple URLs, we need a way to convey this information in the JSON representation.
          </p>

          <pre class="example">
            &lt;div class="h-entry"&gt;
              &lt;video class="u-video" width="640" height="360" preload controls&gt;
                &lt;source src="sample_h264.mov" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' /&gt;
                &lt;source src="sample_ogg.ogv" type='video/ogg; codecs="theora, vorbis"' /&gt;
                &lt;source src="sample_webm.webm" type='video/webm; codecs="vp8, vorbis"' /&gt;
              &lt;/video&gt;
            &lt;/div&gt;
          </pre>

          <pre class="example">
            {
              "type": "entry",
              "video": [
                {
                  "content-type": "video/mp4",
                  "url": "sample_h264.mov"
                },
                {
                  "content-type": "video/ogg",
                  "url": "sample_ogg.ogg"
                },
                {
                  "content-type": "video/webm",
                  "url": "sample_webm.webm"
                }
              ]
            }
          </pre>

        </section>
      </section>
    </section>
            
    <section id="using-references">
      <h2>Using References</h2>
      <p>
        The purpose of the <a>references</a> property is to exclude any non-authoritative
        data from the defined object.  To do this, non-authoritative data is moved so
        that implementations looking to process only authoritative data may simply ignore 
        the references property and fetch any data that would be contained there from its
        authoritative source.
      </p>
      <p>
        If a property is a reference to an object that is defined authoritatively in
        some other location, the <a>references</a> property SHOULD be used.  The property
        SHOULD contain only the unique identifier or URL where the authoritative data
        may be found.  In the references object, the URL or unique identifier MAY
        be entered as the key field and a serialization of the referenced object MAY
        be provided.  This serialization of the referenced object MAY be incomplete
        so as to provide only necessary data.
      </p>
      <p>
        Parsing implementations SHOULD fetch data from the authoritative source instead of using
        the references object.
      </p>
      <section id="">
        <h3>Example of References</h3>
          <pre class="example">
            {
              "type": "entry",
              "published": "2015-10-20T15:49:00-0700",
              "url": "http://example.com/post/fsjeuu8372",
              "author": "http://alice.example.com",
              "name": "Hello World",
              "content": "This is a blog post",
              "category": "Posts",
              "references": {
                "http://alice.example.com": {
                  "type": "card",
                  "name": "Alice",
                  "url": "http://alice.example.com",
                  "photo": "http://alice.example.com/photo.jpg"
                }
              }
            }
          </pre>

          <pre class="example">
            {
              "type": "entry",
              "published": "2015-10-20T15:49:00-0700",
              "url": "http://example.com/like/r23eugi02c",
              "author": {
                "type": "card",
                "name": "Alice",
                "url": "http://alice.example.com",
                "photo": "http://alice.example.com/photo.jpg"
              },
              "like-of": "http://bob.example.com/post/100",
              "category": ["Likes", "Posts"],
              "references": {
                "http://bob.example.com/post/100": {
                  "type": "entry",
                  "published": "2015-10-18T12:33:00-0700",
                  "url": "http://bob.example.com/post/100",
                  "author": "http://bob.example.com",
                  "name": "My First Post",
                  "content": "This is my first post on my new blog, I hope you like it"
                },
                "http://bob.example.com": {
                  "type": "card",
                  "name": "Bob",
                  "url": "http://bob.example.com",
                  "photo": "http://bob.example.com/mypicture.jpg"
                }
              }
            }
          </pre>
      </section>

    </section>
    <section id="collections">
      <h2>Collections</h2>

      <p>
        Posts can live inside of collections. A collection may be a home page feed, or a feed of other posts such as a list of contacts, a list of things someone has liked, etc. There is no requirement that all posts in a collection need to be of the same type.
      </p>

      <p>
        The collection may also have its own properties such as "name" or "author". 
      </p>

      <pre class="example">
        {
          "type": "feed",
          "url": "http://alice.example.com/collectionurl",
          "name": "Alice's Home Page",
          "author": {
            "type": "card",
            "name": "Alice",
            "url": "http://alice.example.com",
            "photo": "http://alice.example.com/photo"
          },
          "children": [
            { 
              "type": "entry",
              "content": {
                "html": "<p>Hello World</p>",
                "text": "Hello World"
              }
            },
            {
              "type": "entry",
              "content": {
                "html": "<p>A Second Post</p>",
                "text": "A Second Post"
              }
            }
          ]
        }
      </pre>

      <section id="multiple-items">
        <h3>Multiple items on a page</h3>
        <p>
          If an HTML page contains multiple top-level items, (most commonly found when a page contains a list of [[h-entry]] objects), the parser creates an implicit top-level collection with no properties.
        </p>

        <pre class="example">
          {
            "children": [
              { 
                "type": "entry",
                "content": {
                  "html": "<p>Hello World</p>",
                  "text": "Hello World"
                }
              },
              {
                "type": "entry",
                "content": {
                  "html": "<p>A Second Post</p>",
                  "text": "A Second Post"
                }
              }
            ]
          }
        </pre>

      </section>
    </section>

    <section id="deriving">
      <h2>Deriving the Syntax</h2>
      <p>
        This syntax is derived from HTML with Microformats-2, converted to JSON [[microformats2-parsing]] converted to a simplified JSON. The examples below illustrate the process.
      </p>

      <section id="deriving-note">
        <h3>Deriving a Note</h3>

        <h4>HTML + Microformats</h4>
        <pre class="example">
          &lt;article class="h-entry"&gt;
            &lt;h1 class="p-name"&gt;Hello World&lt;/h1&gt;
            &lt;p&gt;Published by &lt;a class="p-author h-card" href="http://example.com/"&gt;A. Developer&lt;/a&gt;
               on &lt;a href="http://example.com/2015/10/21" class="u-url"&gt;&lt;time class="dt-published" datetime="2015-10-21T12:00:00-0700"&gt;October 21&lt;sup&gt;st&lt;/sup&gt;, 2015&lt;/time&gt;&lt;/a&gt;
           
            &lt;p class="p-summary"&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus imperdiet ultrices pulvinar.&lt;/p&gt;
           
            &lt;div class="e-content"&gt;&lt;p&gt;Donec dapibus enim lacus, &lt;i&gt;a vehicula magna bibendum non&lt;/i&gt;. Phasellus id lacinia felis, vitae pellentesque enim. Sed at quam dui. Suspendisse accumsan, est id pulvinar consequat, urna ex tincidunt enim, nec sodales lectus nulla et augue. Cras venenatis vehicula molestie. Donec sagittis elit orci, sit amet egestas ex pharetra in.&lt;/p&gt;&lt;/div&gt;
          &lt;/article&gt;
        </pre>

        <h4>Parsed Microformats JSON</h4>

        <pre class="example">
        {
          "items": [
            {
              "type": [
                "h-entry"
              ],
              "properties": {
                "author": [
                  {
                    "type": [
                      "h-card"
                    ],
                    "properties": {
                      "name": [
                        "A. Developer"
                      ],
                      "url": [
                        "http://example.com/"
                      ]
                    },
                    "value": "A. Developer"
                  }
                ],
                "name": [
                  "Hello World"
                ],
                "summary": [
                  "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus imperdiet ultrices pulvinar."
                ],
                "url": [
                  "http://example.com/2015/10/21"
                ],
                "published": [
                  "2015-10-21T12:00:00-0700"
                ],
                "content": [
                  {
                    "html": "&lt;p&gt;Donec dapibus enim lacus, &lt;i&gt;a vehicula magna bibendum non&lt;/i&gt;. Phasellus id lacinia felis, vitae pellentesque enim. Sed at quam dui. Suspendisse accumsan, est id pulvinar consequat, urna ex tincidunt enim, nec sodales lectus nulla et augue. Cras venenatis vehicula molestie. Donec sagittis elit orci, sit amet egestas ex pharetra in.&lt;/p&gt;",
                    "value": "Donec dapibus enim lacus, a vehicula magna bibendum non. Phasellus id lacinia felis, vitae pellentesque enim. Sed at quam dui. Suspendisse accumsan, est id pulvinar consequat, urna ex tincidunt enim, nec sodales lectus nulla et augue. Cras venenatis vehicula molestie. Donec sagittis elit orci, sit amet egestas ex pharetra in."
                  }
                ]
              }
            }
          ]
        }
        </pre>

        <h4>Simplified JSON</h4>

        <pre class="example">
        {
          "type": "entry",
          "author": {
            "type": "card",
            "url": "http://example.com",
            "name": "A. Developer"
          },
          "url": "http://example.com/2015/10/21",
          "published": "2015-10-21T12:00:00-0700",
          "name": "Hello World",
          "summary": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus imperdiet ultrices pulvinar.",
          "content": {
            "value": "&lt;p&gt;Donec dapibus enim lacus, &lt;i&gt;a vehicula magna bibendum non&lt;/i&gt;. Phasellus id lacinia felis, vitae pellentesque enim. Sed at quam dui. Suspendisse accumsan, est id pulvinar consequat, urna ex tincidunt enim, nec sodales lectus nulla et augue. Cras venenatis vehicula molestie. Donec sagittis elit orci, sit amet egestas ex pharetra in.&lt;/p&gt;",
            "text": "Donec dapibus enim lacus, a vehicula magna bibendum non. Phasellus id lacinia felis, vitae pellentesque enim. Sed at quam dui. Suspendisse accumsan, est id pulvinar consequat, urna ex tincidunt enim, nec sodales lectus nulla et augue. Cras venenatis vehicula molestie. Donec sagittis elit orci, sit amet egestas ex pharetra in."
          }
        }

        </pre>

      </section>
      <section id="JSON-LD">
        <h2>JSON-LD Consideration</h2>
        <p>
          JF2 documents all have an implicit @context field which is optional.  This @context can be found at 
          <a href="http://www.w3.org/ns/jf2">http://www.w3.org/ns/jf2</a>
          and is provided only to make conversion to [[JSON-LD]] format possible.  Most JF2 will process
          fine in JSON-LD systems, however, this support is not guaranteed and those wishing to
          use JF2 in JSON-LD may need to modify serialization slightly.
        </p>
      </section>
    </section>
    <section id="profiles">
      <h2>Profiles</h2>
      <section id="profile_introduction" class="informative">
        <h3>Intro</h3>
        <p>
          JF2 on its own is intentionally vocabulary independent, that is, any value may contain a single value, a
          set of values, or a structure and there are no requirements that fields be present.  While this keeps
          the fidelity of the original [[microformats2]] encoded HTML, some consuming code can be simplified by
          adding vocabulary requirements.  This creates the need for vocabulary aware profiles of JF2, where
          the profile adds additional constraints on the fields present.
        </p>
      </section>
      <section id="jf2feed">
        <h3>JF2 Feed</h3>

        <section id="jf2feed_intro" class="informative">
          <h4>Introduction</h4>
          <p>
            XML formats have heavily dominated serializations of social activity feeds for blogs and news feeds for years.
            Several attempts have been created over the years to attempt to bring these to a JSON format, most recently
            [[jsonfeed-v1]], which JF2 Feed gets the majority of its requirements from.  JF2 Feed is an attempt to bring
            some of the advantages of these vocabulary aware specifications under a standard vocabulary from
            [[microformats2]].  
          </p>

          <p>
            Fields described below have additional requirements to be considered a valid JF2 Feed, however they may contain
            any number of additional fields from [[h-feed]], [[h-entry]], and [[h-card]].  The entries below are codified as
            they are likely the most useful for feed readers and additional data is expected to be fetchable at the entry URL,
            preferrably though valid [[microformats2]] markup.
          </p>
        </section>

        <section id="jf2feed_required_fields">
          <h4>Required Fields and Required Formats</h4>
          <p>
            The following fields have additional constraints to be a valid JF2 Feed that only apply 
            to the top level feed object, its child entry object, and any properties of them.
          </p>
            
          <ul>
            <li><strong>type</strong> MUST be defined with a value of "feed" on the top level entry.
              All other sub-object items MUST NOT have a type value of "feed".  All direct children
              of the top level feed object MUST have a value of "entry".
            </li>
            <li><strong>name</strong> MUST be defined on the top level "feed" object.  This value MUST
              be a single string value. Any direct children of the top level item SHOULD have this
              property and if present MUST be a single string value.
            </li>
            <li><strong>url</strong> SHOULD be defined on the top level "feed" object.  This value MUST
              be a single string value and is expected to contain the URL of the data which this
              JF2 Feed describes. Additionally, if present in the author property object, or any direct
              child entry object, it MUST contain a single string value only and that value must be a [[URL]].
            </li>
            <li><strong>photo</strong> MUST be a single string value if present on the top level feed
              object, its author property object, or any direct child entry object and MUST be a valid [[URL]].
            </li>
            <li><strong>uid</strong> MUST be present on any entry object which is a direct child of the
              top level feed object.  This property MUST be a single string value and MUST uniquely
              identify this entry object.  This MAY be a duplicate of the entry's url property.
            </li>
            <li><strong>published</strong> SHOULD be present on any entry object which is a direct
              child of the top level feed object.  If present, this property MUST be a single string
              value and MUST be formatted as specified by [[ISO8601]].
            </li>
            <li><strong>updated</strong> MAY be present on any entry object which is a direct
              child of the top level feed object.  If present, this property MUST be a single string
              value and MUST be formatted as specified by [[ISO8601]].
            </li>
            <li><strong>category</strong> MAY be present on any entry object which is a direct
              child of the top level feed object.  If present, this property MUST be an array of
              string values.
            </li>
            <li><strong>author</strong> MAY be present on the top level feed or second level entry 
              objects. If present, it MUST be an object and it MUST contain at least a name, url,
              or photo property.
            </li>
            <li><strong>content</strong> MAY be present on any entry object which is a direct
              child of the top level feed object.  If present, this property MUST be an object as
              described in the <a href="#html-content">HTML content</a> regardless if only a text/plain
              version is available.
            </li>
            <li><strong>summary</strong> MAY be present on any second level entry object. If present,
              it MUST be a single string.
            </li>
            <li><strong>video or audio</strong> MAY be present on any second level entry object. If present,
              it MUST be an object as described in the <a href="#multiple-urls">multiple URLs</a> section with
              at least a 'url' property which MUST be a single string and a valid [[URL]].
            </li>

          </ul>
          <p class="note">
          The format of published and updated fields may change from [[ISO8601]] to [[RFC3339]] or use [[microformats2]]'s more liberal date field.  Please discuss on github issues
          </p>

        </section>

        <section id="jf2feed_discovery">
          <h4>Discovery</h4>
          <p>
          The JF2 Feed for a page may be published as HTTP Link header [[RFC5988]], or as an HTML
          &lt;link&gt; or &lt;a&gt; tag element with the following attributes.
            <pre>rel="alternate" type="application/jf2feed+json" href="http://www.example.com/jf2feed.json" </pre>
          </p>
        </section>
        <section id="jf2feed_example">
          <h4>JF2 Feed Example</h4>

          <pre class="example">
            {
                "type": "feed",
                "url": "https://example.org/myfeed.html",
                "name": "Brent Simmons’s Microblog",
                "author": {
                    "type": "card",
                    "name": "Brent Simmons",
                    "url": "http://example.org/",
                    "photo": "https://example.org/avatar.png"
                },
                "children": [
                    {
                        "type": "entry",
                        "uid": "https://example.org/2347259",
                        "url": "https://example.org/2347259",
                        "content": {
                          "text": "Cats are neat. \n\nhttps://example.org/cats"
                        },
                        "published": "2016-02-09T14:22:00-07:00"
                    }
                ]
            }

          </pre>
        </section>
        <section id="jsonfeed_to_jf2feed" class="informative">
          <h4>JSON Feed to JF2 conversion</h4>

          <p class="note">
            As it is not sane to do this for every feed serialization currently available,
            this section is likely to only be temporary in the spec and may be moved to a
            more permanant home elsewhere.
          </p>

          <p>
            JF2 Feed was based heavily on [[jsonfeed-v1]] and as such it is quite trivial to process a
            JSON Feed as a JF2 Feed with only minor changes.  This section discusses the conversion that
            must be made for this process, most of which is simply conversion of properties to their
            [[microformats2]] equivalent.
          </p>

          <p>
            <strong>Conversion of the top level structure</strong>
          </p>
          <ul>
            <li>Drop or ignore the "version" property</li>
            <li>Create a property "type" with the value "feed"</li>
            <li>Rename the properties "title" to "name", "home_page_url" to "url", "icon" to "photo", and "description" to "summary"</li>
            <li>Modify the "author" property as described below</li>
            <li>Rename the "items" property to "children" and modify as described below</li>
          </ul>

          <p>
            <strong>Conversion of the author property on the top level or on any lower level entry</strong>
          </p>
          <ul>
            <li>Rename the property 'avatar' to 'photo'</li>
          </ul>

          <p>
            <strong>Conversion each entry in items</strong>
          </p>
          <ul>
            <li>Rename the 'id' property to 'uid'</li>
            <li>Convert content_html and content_text in to a single object under the property "content" with properties "html" and "text", leaving out either if not present, or the entire property if neither are present.  </li>
            <li>Rename the properties
              "title" to "name",
              "image" to "photo",
              "date_published" to "published",
              "date_modified" to "updated",
              "tags" to "category",
              "banner_image" to "featured" </li>
            <li>Drop or ignore the 'external_url' property.  If content is not set, it may be useful to set content['text'] to the value of 'external_url'</li>
            <li>Keep "summary" property the same</li>
            <li>
              For each entry in the "attachments" array,
              <ol>
                <li>Rename "mime-type" to "content-type".</li>
                <li>Keep the "url" property as is.</li>
                <li>If the "content-type" field begins with "video/", add the item to the "video" property array.</li>
                <li>If the "content-type" field begins with "photo/", add the item to the "photo" property array.</li>
              </ol>

            </li>


          </ul>
          <p>
            It may be benefitial to drop any properties other than those mentioned to avoid conflicts with any future [[microformats2]] properties.
          </p>


        </section>
      </section>
    </section>

    <section id="extensions">
      <h2>Extension</h2>
      <p>
        JF2 MAY be extended by the [[microformats2]] extension mechanism.  The 'x-*' properties created in this
        way MAY be present in any serialization of JF2.  Parsers MUST NOT halt on any unknown properties they
        encounter.
      </p>
    </section>

    <section id="internationalization" class="informative">
      <h2>Language And Internationalization</h2>
      <p>
        In order to allow any language to be serialized in JF2, the 'lang' value can be set on any object to inform
        annotate the natural language of the text.  Many often ask for control structures like directionality of text
        and multiple language serializations.  Directionality of text can be accomplished with UTF-8 control characters
        which can be added to any of the values in the document.  In addition, any content inside of 'html' properties
        can have any markup as defined by [[HTML5]].
      </p>
      <p>
        Multiple serializations of the same text has not been seen to be needed in practice. 
        The suggested path for accomplishing this with JF2 is to have these hosted at different locations. 
        For example, it is common practice on websites to host an alternate language version of a site under a different
        directory structure for each language (such as /en/, /jp/, /fr/, etc).
      </p>
    </section>

    <section id="implementations" class="informative">
      <h2>Implementations</h2>
      <p>
        The following is a list of currently known implementations of JF2-like formats and their current differences to this document .
      </p>

      <section id="webmention.io">
        <h3>Webmention.io</h3>
        <p>
        <a href="https://webmention.io">Webmention.io</a> is a hosted service for handling Webmentions.
          Webmentions are accessed from an API that that returns a set of objects in JSON format similar to JF2.
          The key difference is the inclusion of some additional data wrapping the objects
          (source, verified, verified_data, etc) and all wrapped in a "links" array.
          Code available at <a href="https://github.com/aaronpk/webmention.io">https://github.com/aaronpk/webmention.io</a>
        </p>
      </section>

      <section id="xray">
        <h3>XRay</h3>
        <p>
        <a href="https://xray.p3k.io">X-Ray</a> is a tool to return structured data from any URL.
          Code available at <a href="https://github.com/aaronpk/XRay">https://github.com/aaronpk/XRay</a>
        </p>
      </section>

      <section id="unmung">
        <h3>Unmung</h3>
        <p>
        <a href="http://www.unmung.com">Unmung</a> is a tool for converting various formats.
          Code available at <a href="https://github.com/kevinmarks/unmung">https://github.com/kevinmarks/unmung</a>
        </p>
      </section>


      <section id="socialstreams">
        <h3>SocialStreams</h3>
        <p>
        <a href="http://stream.thatmustbe.us">SocialStreams</a> is a translation service for converting social formats.
          Code available at <a href="https://github.com/dissolve/socialstream">https://github.com/dissolve/socialstream</a>
        </p>
      </section>

      <section id="mf2util">
        <h3>mf2util</h3>
        <p>
          Mf2util is a utility library for interpreting Microformats-2.
          Code available at <a href="https://github.com/kylewm/mf2util">https://github.com/kylewm/mf2util</a>
        </p>
      </section>
    </section>

    <section id="privacy">
      <h2>Privacy Considerations</h2>

      <p>
        As with any serialization format, JF2 streams can potentially contain private and personally identifiable information.
        As such, producing and consuming implementations SHOULD take a default stance that all information in these documents are 
        private and take steps to ensure the privacy of their users.  This can include transmission only over secure connections,
        limiting access to streams, deletion of stored secure information, or any other steps that would apply to any private
        information.
      </p>
    </section>

    <section id="security-considerations">
      <h2>Security Considerations</h2>

      <p>
        JF2 is not intended to contain executable code however, as JF2 allows arbitrary text it may be possible for publishers
        to craft text in an executable fashion.  As such, JF2 documents should not be passed through any executable mechanism
        such as JavaScript's eval() function to be parsed.  Processing of field contents should not execute any encountered code
        and it is recommended that any HTML formatted content be filtered to remove any executable code such as script and style tags.
      </p>

      <p>
        JF2 documents may require privacy and integrity services depending on the document content and implementation
        concerns.  If such services are required, they must be provided externally such as by the use of SSL/TLS connections
        to prevent forgery or exposure of data.
      </p>

      <p>
        Any externally linked documents must be processed by their own format's security model. JF2 documents do not make any claims
        about the security of any externally referenced documents.
      </p>

      <p>
        JF2 Streams are JSON Documents and are subject to the same security considerations described in [[!RFC7159]].
      </p>

    </section>



  <section id="iana">

    <h2>IANA Considerations</h2>

    <section id="media-type">
      <h2>The <code>application/jf2feed+json</code> Media Type</h2>

      <p>
        This specification registers the <code><dfn>application/jf2feed+json</dfn></code> MIME Media Type specifically for identifying documents
        conforming to the JF2 format with the JF2 Feed profile.
      </p>

      <table>
        <tr>
          <td>Type name: </td>
          <td>application</td>
        </tr>
        <tr>
          <td>Subtype name: </td>
          <td>jf2feed+json</td>
        </tr>
        <tr>
          <td>Required parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Optional parameters: </td>
          <td>None</td>
        </tr>
        <tr>
          <td>Encoding considerations: </td>
          <td>
            Binary, as per [[RFC6839]], section 3.1; the charset parameter is not used and byte-order marks are not permitted, as per [[RFC7159]], sections 11 and 8.1
          </td>
        </tr>
        <tr>
          <td>Security considerations: </td>
          <td>See [[RFC7159]] section 12 and the <a href="https://www.w3.org/TR/jf2/#security-considerations">Security Considerations</a> section of this specification.</td>
        </tr>
        <tr>
          <td>Contact: </td>
          <td>
            Ben Roberts &lt;<a href="mailto:ben@thatmustbe.me">ben@thatmustbe.me</a>&gt;
          </td>
        </tr>
        </table>

    </section>

  </section>


    <section class="appendix">
      <h2>Change Log</h2>
        <section>
          <h3>Changes from 27 June 2017 WD to this version</h3>

          <p>This section lists changes from the <a href="https://www.w3.org/TR/2017/WD-jf2-20170627/">27 June 2017 WD</a> to this version.</p>

          <ul>
            <li>Expanded and corrected examples.</li>
            <li>Added a <a href="#conformance">Conformance</a> section.</li>
            <li>Added links to validator, implementation reports, and sample set.</li>
          </ul>

        </section>
        <section>
          <h3>Changes from 12 June 2017 WD to 27 June 2017</h3>

          <p>This section lists changes from the <a href="https://www.w3.org/TR/2017/WD-jf2-20170612/">12 June 2017 WD</a> to <a href="https://www.w3.org/TR/2017/WD-jf2-20170627/">27 June 2017 WD</a>.</p>

          <ul>
            <li>Remove at-risk warning for JF2 Feed Discovery via 'a' tags in body</li>
            <li>Updated Security Considerations</li>
          </ul>

        </section>
        <section>
          <h3>Changes from 28 July 2016 FPWD to 12 Jun 2017 WD</h3>

          <p>This section lists changes from the <a href="https://www.w3.org/TR/2016/WD-jf2-20160728/">28 July 2016 FPWD</a> to <a href="https://www.w3.org/TR/2017/WD-jf2-20170612/">12 June 2017 WD</a></p>

          <ul>
            <li>Changed format of HTML content items</li>
            <li>Added Profiles section to allow for JF2 Feed</li>
            <li>Added Extension Section</li>
            <li>Added Privacy section</li>
            <li>Added Security Considerations section</li>
            <li>Added Internationalization section</li>
            <li>Added IANA Considerations section for JF2 Feed</li>
            <li>Corrections to referenced URLs</li>
            <li>Updated Introduction and Authors Note</li>
            <li>Minor Editorial Changes</li>
          </ul>

        </section>
    </section>

    <section class="appendix">
      <h2>Acknowledgements</h2>
        <p>
          The authors wish to thank the Microformats, IndieWeb, Pump.io, and Activity Streams communities for their continued work
          in building the social web and helping define standards such as this one.  This includes, but is certainly not limited to, 
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="https://aaronparecki.com/">Aaron Parecki</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://bengo.is/">Benjamin Goering</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://inessential.com/">Brent Simmons</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://dustycloud.org/">Christopher Webber</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://www.wilkie.how/">Dave Wilkinson II</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://www.chmod777self.com/">James Snell</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="https://cleverdevil.io/">Jonathan LaCour</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="https://kylewm.com/">Kyle Mahan</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://manton.org/">Manton Reece</a></span>,
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://kodfabrik.se/">Pelle Wessman</a></span>,
          and 
          <span class="h-card vcard" typeof="foaf:Person"><a class="u-url url p-name fn" property="foaf:homepage" href="http://tantek.com/">Tantek Çelik</a></span>.
        </p>
    </section>
  </body>
</html>
